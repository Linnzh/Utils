## 迭代器模式 - Iterator

概念：提供一种方法顺序访问一个聚合对象中的各个元素，而又不需要暴露该对象的内部表示。

又名**游标（Cursor）模式**。该模式的关键思想是**将对列表的访问和遍历从列表对象中分离出来，并放入一个迭代器（iterator）对象中**。迭代器类定义了一个访问该列表元素的接口。迭代器对象负责跟踪当前元素，即它已经知道哪些元素已经被遍历过了。

![迭代器设计模式](assets/设计模式/iterator-zh.png)

### 适用性

- 访问一个聚合对象的内容而无需暴露它的内部表示。
- 支持对聚合对象的多种遍历：深度优先遍历、广度优先遍历等。
- 为遍历不同的聚合结构提供一个统一的接口（即支持多态迭代）。

### 特点

- 支持以不同的方式遍历一个聚合。例如代码生成和语义检查要遍历语法分析树。
- 简化了聚合的接口。
- 在同一个聚合上可以有多个遍历，每个迭代器保持它自己的遍历状态，可以同时进行多个遍历。

### 参与者

- Iterator（迭代器接口）
    - 定义访问和遍历元素的接口。
- ConcreteIterator（具体迭代器）
    - 实现迭代器接口。
    - 对该聚合遍历时，跟踪当前位置。
- Aggregate（聚合/集合）
    - 定义创建相应迭代器对象的接口。
- ConcreteAggregate（具体聚合/集合）
    - 实现创建相应迭代器的接口，该操作返回 ConcreteIterator 的一个适当的实例。

### 案例

- 各类列表，包括堆、栈、队列、树、图等。

### 对现有业务的思考

目前没有太多用到遍历的地方。看看一些网上示例吧😭并且 PHP 已有 Iterator 接口。



```php
public function testExample(): void
{
    $csv = new CsvIterator(__DIR__ . '/cats.csv');

    foreach ($csv as $key => $row) {
        print_r($row);
    }

    $this->assertIsIterable($csv);
}
```
